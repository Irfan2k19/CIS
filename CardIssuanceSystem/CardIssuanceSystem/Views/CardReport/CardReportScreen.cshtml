
@{
    ViewBag.Title = "Card Report";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container">
    <div class="form-group row">
        <div class="col-sm-3">
            <label class="control-label">Card Number</label>
            <input type="text" class="form-control CardNo" placeholder="Card No." maxlength="16">
        </div><!-- End col-sm-3 -->


        <div class="col-sm-6">
            <button class="btn btn-cstm btn-search">Search</button>
        </div><!-- End col-sm-9 -->
    </div><!-- End row -->

    <div id="ResultForm">

        <div id="UnEditable">
        <h4 class="main_hdng">Card Information</h4>

        <div class="row form-group">
            <div class="col-sm-3">
                <label class="control-label">Card Number</label>
                <input type="text" class="form-control"  id="CardNo">
            </div><!-- End col-sm-3 -->

            <div class="col-sm-3">
                <label class="control-label">Card Title</label>
                <input type="text" class="form-control" id="CardTitle">
            </div><!-- End col-sm-3 -->

            <div class="col-sm-3">
                <label class="control-label">Card Issuance</label>
                <input type="text" class="form-control" id="CardIssuance">
            </div><!-- End col-sm-3 -->

            <div class="col-sm-3">
                <label class="control-label">Card Expiry</label>
                <input type="text" class="form-control" id="CardExpiry">
            </div><!-- End col-sm-3 -->
        </div>

        <div class="row form-group">
            <div class="col-sm-3">
                <label class="control-label">Card Type</label>
                <input type="text" class="form-control" id="CardType">
            </div><!-- End col-sm-3 -->

            <div class="col-sm-3">
                <label class="control-label">Default Account Number</label>
                <input type="text" class="form-control" placeholder="Account Number" id="AccountNo">
            </div><!-- End col-sm-3 -->

            <div class="col-sm-3">
                <div class="checkbox">
                    <label>
                        <input type="checkbox" id="CardActive" unchecked=""><span class="checkbox-material"><span class="check"></span></span>
                        Card Active
                    </label>
                </div>
            </div><!-- End col-sm-3 -->
        </div>
                <h4 class="main_hdng">Customer Information</h4>

                <div class="row form-group">
                    <div class="col-sm-3">
                        <label class="control-label">Customer ID</label>
                        <input type="text" class="form-control" placeholder="344565" id="CustomerId">
                    </div><!-- End col-sm-3 -->

                    <div class="col-sm-3">
                        <label class="control-label">Customer Name</label>
                        <input type="text" class="form-control" placeholder="Customer Name" id="CustomerName">
                    </div><!-- End col-sm-3 -->

                    <div class="col-sm-3">
                        <label class="control-label">Account Title</label>
                        <input type="text" class="form-control" placeholder="Account Title" id="AccountTitle">
                    </div><!-- End col-sm-3 -->

                   
                    <div class="col-sm-3">
                        <label class="control-label">Account Status</label>

                        <input type="text" class="form-control" placeholder="AccountStatus" id="AccountStatus">
                    </div><!-- End col-sm-3 -->
                </div><!-- End row -->

                <div class="row form-group">
                    <div class="col-sm-3">
                        <label class="control-label">Linked Account</label>
                        <textarea class="form-control" placeholder="Linked Accounts" id="LinkedAccounts"></textarea>
                        @*<input type="text" class="form-control" placeholder="Linked Accounts" id="LinkedAccounts">*@
                    </div><!-- End col-sm-3 -->

                    <div class="col-sm-3">
                        <label class="control-label">Account Product</label>
                        <input type="text" class="form-control" placeholder="Account Product" id="Product">
                    </div>

                    <div class="col-sm-6">
                        <label class="control-label">Main Address</label>
                        <input type="text" class="form-control" placeholder="Account Address" id="AccountAddress">
                    </div>

                    @*<div class="col-sm-3">
                        <label class="control-label">Customer Address</label>
                        <input type="text" class="form-control" placeholder="Customer Address" id="CustomerAddress">
                    </div>

                    <div class="col-sm-3">
                        <label class="control-label">Other Address</label>
                        <input type="text" class="form-control" placeholder="Address" id="OtherAddress">
                    </div>*@
                   
                </div><!-- End row -->

                <div class="row form-group">
                    <div class="col-sm-3">
                        <label class="control-label">Main Mobile</label>
                        <input type="text" class="form-control" placeholder="123456789" id="MobileNo">
                    </div><!-- End col-sm-3 -->
                    <div class="col-sm-3">
                        <label class="control-label">Main Landline</label>
                        <input type="text" class="form-control" placeholder="Phone Res" id="PhoneRes">
                    </div><!-- End col-sm-3 -->

                    @*<div class="col-sm-3">
                        <label class="control-label">Phone Off</label>
                        <input type="text" class="form-control" placeholder="Phone Off" id="PhoneOff">
                    </div>*@<!-- End col-sm-3 -->

                
                    <div class="col-sm-3">
                        <label class="control-label">Email</label>
                        <input type="email" class="form-control" placeholder="#Email" id="Email">
                    </div><!-- End col-sm-3 -->
                </div><!-- End row -->

                <div class="row form-group">
                    <div class="col-sm-3">
                        <label class="control-label">Father's Name</label>
                        <input type="text" class="form-control" placeholder="Father Name" id="FatherName">
                    </div><!-- End col-sm-3 -->

                    <div class="col-sm-3">
                        <label class="control-label">Mother's Maiden Name</label>
                        <input type="text" class="form-control" placeholder="Mother Name" id="MotherName">
                    </div><!-- End col-sm-3 -->

                    <div class="col-sm-3">
                        <label class="control-label">Date of Birth</label>
                        <div class='input-group date'>
                            <input type='text' class="form-control" id="DateofBirth" />
                            <span class="input-group-addon">
                                <span class="glyphicon glyphicon-calendar"></span>
                            </span>
                        </div><!-- End datepicker -->
                    </div><!-- End col-sm-3 -->

                    <div class="col-sm-3">
                    </div><!-- End col-sm-3 -->
                </div><!-- End row -->

                <div class="row form-group">
                    <div class="col-sm-3">
                        <label class="control-label">Identification</label>
                        <select class="form-control" id="Identification">
                            <option>Identification</option>
                        </select>
                    </div><!-- End col-sm-3 -->

                    <div class="col-sm-3">
                        <label class="control-label">Identification No</label>
                        <input type="text" class="form-control" placeholder="Identification No" id="CNIC">
                    </div><!-- End col-sm-3 -->

                    <div class="col-sm-3">
                        <label class="control-label">Old NIC</label>
                        <input type="text" class="form-control" placeholder="Old NIC" id="OldCNIC">
                    </div><!-- End col-sm-3 -->

                    <div class="col-sm-3">
                    </div><!-- End col-sm-3 -->
                </div><!-- End row -->

                <h4 class="main_hdng" style="display:none">Account Information</h4>

                <div class="row form-group" style="">
                    <div class="col-sm-3">
                        <label class="control-label">Operating Instructions</label>
                        <input type="text" class="form-control operating-ins" placeholder="Operating Instructions">
                    </div><!-- End col-sm-3 -->

                    <div class="col-sm-3">
                        <label class="control-label">Nationality</label>
                        <input type="text" class="form-control nationality" placeholder="Nationality">
                    </div><!-- End col-sm-3 -->

                    <div class="col-sm-3">
                        <label class="control-label">Residence</label>
                        <input type="text" class="form-control" placeholder="Residence" id="residence">
                    </div><!-- End col-sm-3 -->
                    <div class="col-sm-3">
                        <label class="control-label">Request#</label>
                        <input type="text" class="form-control" placeholder="requestno" id="requestno">
                    </div><!-- End col-sm-3 -->
                </div><!-- End row -->

                <div class="row form-group" style="">
                    <div class="col-sm-3">
                        <label class="control-label">Phone Office</label>
                        <input type="text" class="form-control" placeholder="Phone Office" id="phoneoff">
                    </div><!-- End col-sm-3 -->
                    <div class="col-sm-3">
                        <label class="control-label">Phone Residence</label>
                        <input type="text" class="form-control" placeholder="Phone Residence" id="phoneres">
                    </div><!-- End col-sm-3 -->
                    <div class="col-sm-3">
                        <label class="control-label">Card Nature</label>
                        <input type="text" class="form-control" placeholder="Card Nature" id="cardnature">
                    </div><!-- End col-sm-3 -->
                    <div class="col-sm-3">
                        <label class="control-label">Charge Waived</label>
                        <input type="text" class="form-control" placeholder="Charge Waived" id="chargewaived">
                    </div><!-- End col-sm-3 -->
                  
                </div><!-- End row -->

            <div class="row form-group" style="">
                <div class="col-sm-3">
                    <label class="control-label">Customer Sector</label>
                    <input type="text" class="form-control" placeholder="Customer Sector" id="sector">
                </div><!-- End col-sm-3 -->
                <div class="col-sm-3">
                    <label class="control-label">Creator</label>
                    <input type="text" class="form-control" placeholder="Creator" id="creator">
                </div><!-- End col-sm-3 -->
                <div class="col-sm-3">
                    <label class="control-label">Authorizer</label>
                    <input type="text" class="form-control" placeholder="Authorizer" id="authorizer">
                </div><!-- End col-sm-3 -->
                <div class="col-sm-3">
                </div><!-- End col-sm-3 -->

            </div><!-- End row -->
            </div>


        <div class="btns_right" style="display:none;">
            <button class="btn btn-cstm" type="submit" id="NewSubmit">Proceed</button>
            <button class="btn btn-cstm btn-light" onclick="location.reload();">Cancel</button>
        </div><!-- End btns_right -->

    </div>


</div><!-- End container -->
<script type="text/javascript">
    $(document).ready(function () {
        $('#ResultForm').css("display", "none");
        $("#UnEditable :input").attr("disabled", true);
        //$("#Waive").attr("disabled", false);
    });


    $('.btn-search').click(function () {
     


        var CardNo = $('.CardNo').val();
        if (CardNo == null || CardNo.trim() == "" || typeof (CardNo) == "undefined") {
            $('.CardNo').css("border", "red solid 1px");
            alert("Please Enter Card Number");
            return false;
        }
        if (!NumberValue(CardNo)) {

            alert("Only Numeric Value is Allowed");
            return false;
        }



        var Url = '@Url.Action("SearchCardDetail", "CardReport")';
        ShowLoader();
        ajaxCall(Url, {CardNo: CardNo}, function (resp) {
            debugger
            HideLoader();
            if (typeof (resp) === "object" && resp.ErrorMessage == '@CardIssuanceSystem.Core.Helpers.CustomMessages.Success')
            {
                var data = '';
                if (resp.DelinkInfoStr != null)
                {
                    for (var i = 0; i < resp.DelinkInfoStr.length; i++) {
                        data += resp.DelinkInfoStr[i].LinkAccount + ',';

                    }
                }

                
                

                
                $('#LinkedAccounts').val(data);
                //$('#LinkedAccounts').val(data);
                $('#AccountNo').val(resp.Result[0].AccountNo)
                $('#CardNo').val(resp.Result[0].CardNo);
                $('#CardTitle').val(resp.Result[0].CardTitle);
                //var CardIssuance = resp.CardIssuance.substring(0, 10);
                //var CardExpiry = resp.CardExpiry.substring(0, 10);
                var CardIssuance = resp.Result[0].CardIssuanceStr.slice(0, -7);
                var CardExpiry = resp.Result[0].CardExpiryStr.slice(0, -7);

                $('#CardIssuance').val(CardIssuance);
                $('#CardExpiry').val(CardExpiry);
                debugger
                $('#CardType').val(resp.CardType);

                if (resp.Result[0].CardStatusActive == true)
                {
                    debugger
                    $('#CardActive').prop('checked',true);
                } else
                {
                    $('#CardActive').prop('checked', false);

                }

                $('#CustomerId').val(resp.Result[0].CIF);
                $('#CustomerName').val(resp.Result[0].CustomerName);
                //$('#CardTitle').val(resp.Result[0].CustomerName);

                if (resp.Result[0].AccountStatusActive == false)
                {
                    debugger
                    $('#AccountStatus').val('InActive');
                } else
                {
                    $('#AccountStatus').val('Active');
                }

                $('#AccountAddress').val(resp.Result[0].MainAddress);
                $('#CustomerAddress').val(resp.Result[0].Address2);
                $('#OtherAddress').val(resp.Result[0].MainAddress);
                $('#MobileNo').val(resp.Result[0].MainMobile);
                $('#PhoneRes').val(resp.Result[0].MainLandline);
                $('#PhoneOff').val(resp.Result[0].PhoneOffice);
                
                $('#Email').val(resp.Result[0].Email);
                $('#FatherName').val(resp.Result[0].FatherName);
                $('#MotherName').val(resp.Result[0].MotherMaidenName);
                //var DOB = resp.DOB.substring(0, 10);

                var DOB = resp.Result[0].DOB.slice(0, -7);

                $('#DateofBirth').val(DOB);
                $('#Identification option:selected').text(resp.Result[0].IdentificationType);
                $('#CNIC').val(resp.Result[0].Identification);
                //$('#OldCNIC').val();
                $('#Product').val(resp.Product);
                $('.operating-ins').val(resp.AccountResponse.OpInstructions);
                $('.nationality').val(resp.Result[0].Nationality);
                $('#residence').val(resp.Result[0].ResidenceStatus);
                $('#requestno').val(resp.Request.ID);
                $('#phoneoff').val(resp.Result[0].PhoneOffice);
                $('#phoneres').val(resp.Result[0].LandlineNo);
                $('#cardnature').val(resp.Request.RequestType === "N" ? "Primary" : "Secondary");
                $('#chargewaived').val(resp.Request.Waive);
                $('#sector').val(resp.AccountResponse.Sector);
                $('#creator').val(resp.Creator);
                $('#authorizer').val(resp.Authorizer);

                $('#AccountTitle').val(resp.Result[0].AccountTitle);

                $('#ResultForm').css("display", "block");
                
            }
            else if (resp.ErrorMessage == '@CardIssuanceSystem.Core.Helpers.CustomMessages.CardNotExists')
            {
                alert(resp.ErrorMessage);
            } else
            {
                alert("No Record Found");
            }
        }, function (fail)
        {
            HideLoader();
            alert("Failure");
        }, function (err)
        {
            HideLoader();
            alert("Error");
        });

    });





    $(window).on('load', function ()
    {

    });
</script>

